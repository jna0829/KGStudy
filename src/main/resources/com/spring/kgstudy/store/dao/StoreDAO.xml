<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.kgstudy.store.dao.StoreDAO">

<sql id="search">
        <if test="type == 'name'">WHERE sotre_name LIKE '%'||#{keyword}||'%'</if>
        <if test="type == 'id'">WHERE sotre_id = #{keyword}</if>
        <if test="type == 'address'">WHERE store_address LIKE '%'||#{keyword}||'%' or store_road_address LIKE '%'||#{keyword}||'%' </if>
        <if test="type == 'tc'">
            WHERE sotre_name LIKE '%'||#{keyword}||'%'
            OR store_address LIKE '%'||#{keyword}||'%' or store_road_address LIKE '%'||#{keyword}||'%'
        </if>
</sql>


<insert id="insertStore">

insert into store_table(sotre_id,user_id,store_name,store_address,store_road_address,store_tel,store_info,store_lat,store_lng)
				values(store_seq.nextval,#{userId},#{storeName},#{storeAddress},#{storeRoadAddress},#{storeTel},#{storeInfo},#{storeLat},#{storeLng})

</insert>






<select id="findAllStore">

select *, ROW_NUMBER() rn from
(select * from store_table
<include refid="search"/>

order by sotre_id


) where rn between #{page}-1*#{amount}+1 and  #{page}*#{amount}

</select>


<select id="findOneStore">

select * from store_table
<include refid="search"/>


</select>


<select id="searchStoreCnt">

select count(*) from store_table
<include refid="search"/>

</select>


<update id="updateStore">
update store_table set
	user_id=#{userId}, store_name =#{storeName}, 
	store_address=#{storeAddress}, store_road_address=#{storeRoadAddress}, 
	store_tel=#{storeTel}, store_info=#{storeInfo} 
	where store_id = #{storeId}

</update>


<delete id="deleteStore">

delete store_table where store_id=#{storeId}


</delete>













</mapper>