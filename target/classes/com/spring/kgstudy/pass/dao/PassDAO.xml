<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.kgstudy.pass.dao.PassDAO">


<sql id="search">
        <if test="type == 'user'">WHERE user_id = #{keyword}</if>
        <if test="type == 'id'">WHERE pass_id = #{keyword}</if>
        <if test="type == 'order'">WHERE order_id= #{keyword}</if>
</sql>



<insert id="insertPass">

insert into pass_table(pass_id, order_id, user_id, pass_type, pass_time, pass_start, pass_end, pass_price, pass_name, pass_state)
			values(pass_seq.nextval, #{orderId}, #{userId}, #{passType}, #{passTime}, #{passStart}, #{passEnd}, #{passPrice}, #{passName}, #{passState});

</insert>

<select id="findAllPass" resultType="com.spring.kgstudy.pass.vo.PassVO">


select *, ROW_NUMBER() rn from
(select * from pass_table
<include refid="search"/>

order by pass_id desc


) where rn between #{page}-1*#{amount}+1 and  #{page}*#{amount}






</select>


<select id="findOnePass" resultType="com.spring.kgstudy.pass.vo.PassVO">


select * from pass_table
<include refid="search"/>




</select>


<select id="searchPassCnt" resultType="int">


select count(*) from pass_table
<include refid="search"/>


</select>

<update id="updatePass">

update pass_table set pass_time=#{passTime} , pass_start = #{passStart} , pass_end =#{passEnd}, pass_state = #{passState}
				where pass_id = #{passId}
				

</update>



<delete id="deletePass">

delete pass_table where pass_id=#{passId}


</delete>













</mapper>